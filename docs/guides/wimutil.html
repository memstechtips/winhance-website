<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WIMUtil Guide - Winhance Docs</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Overpass:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap">
    <link rel="stylesheet" href="../../styles.css">
    <link rel="stylesheet" href="../css/docs-main.css">
    <link rel="stylesheet" href="../css/docs-sidebar.css">
    <link rel="stylesheet" href="../css/docs-syntax.css">
    <script src="../js/theme-load.js"></script>
    
</head>

<body>
    <header>
        <div class="header-container">
            <div class="logo">
                <a href="../index.html" style="display: flex; align-items: center; text-decoration: none;">
                    <img src="../../images/winhance-rocket.png" alt="Winhance Logo"
                        style="height: 32px; margin-right: 12px;">
                    <h1 style="font-size: 1.5rem; margin: 0; color: var(--text-color);">Winhance <span
                            style="font-weight: 300; opacity: 0.7;">Docs</span></h1>
                </a>
            </div>
            <div class="search-container">
                <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
                <input type="text" id="docs-search" placeholder="Search documentation...">
            </div>
            <div style="display: flex; align-items: center; gap: 1rem;">
                <button id="theme-toggle" class="theme-toggle-btn" title="Toggle theme">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path
                            d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364-6.364l-.707.707M6.343 17.657l-.707.707m12.728 0l-.707-.707M6.343 6.343l-.707-.707M12 8a4 4 0 100 8 4 4 0 000-8z" />
                    </svg>
                </button>
                <a href="https://github.com/memstechtips/Winhance" target="_blank" class="icon-btn github-btn"
                    title="GitHub">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                        fill="currentColor">
                        <path
                            d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" />
                    </svg>
                </a>
            </div>
        </div>
    </header>

    <div class="docs-wip-banner">
        <strong>Work in Progress:</strong> Documentation is a work in progress. Some pages may be incomplete.
    </div>

    <div class="docs-layout has-banner">
                        <aside class="docs-sidebar">
            <nav>
                <div class="sidebar-nav-group">
                    <div class="sidebar-nav-title">Getting Started</div>
                    <a href="../getting-started/installation.html" class="sidebar-nav-item">Installation</a>
                    <a href="../getting-started/quick-start.html" class="sidebar-nav-item">Quick Start</a>
                </div>

                <div class="sidebar-nav-group">
                    <div class="sidebar-nav-title">Features</div>
                    <a href="../features/software-apps.html" class="sidebar-nav-item">Software & Apps</a>
                    <div class="sidebar-sub-nav">
                        <a href="../features/software-apps/windows-apps.html" class="sidebar-nav-item sub-item">Windows Apps</a>
                        <a href="../features/software-apps/external-apps.html" class="sidebar-nav-item sub-item">External Apps</a>
                    </div>
                    <a href="../features/optimize.html" class="sidebar-nav-item">Optimize</a>
                    <div class="sidebar-sub-nav">
                        <a href="../features/optimizations/privacy-security.html" class="sidebar-nav-item sub-item">Privacy & Security</a>
                        <a href="../features/optimizations/power.html" class="sidebar-nav-item sub-item">Power</a>
                        <a href="../features/optimizations/gaming-performance.html" class="sidebar-nav-item sub-item">Gaming & Performance</a>
                        <a href="../features/optimizations/update.html" class="sidebar-nav-item sub-item">Update</a>
                        <a href="../features/optimizations/notifications.html" class="sidebar-nav-item sub-item">Notifications</a>
                        <a href="../features/optimizations/sound.html" class="sidebar-nav-item sub-item">Sound</a>
                    </div>
                    <a href="../features/customize.html" class="sidebar-nav-item">Customize</a>
                    <div class="sidebar-sub-nav">
                        <a href="../features/customizations/theme.html" class="sidebar-nav-item sub-item">Windows Theme</a>
                        <a href="../features/customizations/taskbar.html" class="sidebar-nav-item sub-item">Taskbar</a>
                        <a href="../features/customizations/start-menu.html" class="sidebar-nav-item sub-item">Start Menu</a>
                        <a href="../features/customizations/explorer.html" class="sidebar-nav-item sub-item">Explorer</a>
                    </div>
                    <a href="../features/advanced-tools.html" class="sidebar-nav-item">Advanced Tools</a>
                    <a href="../features/settings.html" class="sidebar-nav-item">Settings</a>
                </div>

                <div class="sidebar-nav-group">
                    <div class="sidebar-nav-title">User Guides</div>
                    <a href="../guides/configuration-files.html" class="sidebar-nav-item">Configuration Files</a>
                    <a href="../guides/wimutil.html" class="sidebar-nav-item">WIMUtil Guide</a>
                    <a href="../guides/autounattend.html" class="sidebar-nav-item">Autounattend Guide</a>
                </div>

                <div class="sidebar-nav-group">
                    <div class="sidebar-nav-title">Reference</div>
                    <a href="../reference/cli-commands.html" class="sidebar-nav-item">CLI Commands</a>
                    <a href="../reference/changelog.html" class="sidebar-nav-item">Changelog</a>
                    <a href="../reference/troubleshooting.html" class="sidebar-nav-item">Troubleshooting</a>
                    <a href="../reference/contributing.html" class="sidebar-nav-item">How to Contribute</a>
                </div>
            </nav>
        </aside>

        <main class="docs-content">
            <section id="wimutil">
                <h1>WIMUtil Step-by-Step Guide</h1>
                <div class="video-container">
                    <iframe src="https://www.youtube-nocookie.com/embed/lrq3ph3xi50?start=3589" title="I Made an App that Debloats and Optimizes Windows 10/11 in 1min20s (BIG Winhance Update)" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                </div>
                <p>WIMUtil (Windows Installation Media Utility) is designed to make creating a custom Windows installer
                    as simple as possible. Follow this guide to create your first customized ISO.</p>

                <div class="callout callout-warning">
                    <div class="callout-title">Important: Official ISOs Only</div>
                    <p>WIMUtil is designed to work only with <strong>official Microsoft Windows 10 and Windows 11 ISO files</strong>. Although Custom ISOs from third-party sources might work, they are not supported.</p>
                </div>

                <img src="../../images/wimutil-view.png" alt="Winhance WIMUtil Interface" class="screenshot" style="width: 100%; border-radius: 8px; margin: 1.5rem 0; box-shadow: 0 4px 20px rgba(0,0,0,0.3);">

                <div class="step-card">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h2>Select and Extract your Windows ISO</h2>
                        <p>First, you need an official Windows 10 or 11 ISO file. You can download these directly from
                            Microsoft using the download links provided in the WIMUtil interface.</p>

                        <h3 style="margin-top: 1.5rem; font-size: 1.1rem; color: var(--accent-color);">1a. Extract the ISO</h3>
                        <ul>
                            <li>Select your ISO using the <strong>Select ISO</strong> button.</li>
                            <li>Choose a <strong>Working Directory</strong> on a drive with at least 15-20GB of free
                                space. This is where the ISO contents will be extracted.</li>
                            <li><strong>Already Extracted?</strong> If you've previously extracted an ISO to a folder, check the <strong>"ISO already extracted"</strong> checkbox, then select that folder. This skips the extraction step.</li>
                            <li>Click <strong>Start Extraction</strong>. Winhance will mount the ISO and copy its
                                contents to your working directory.</li>
                        </ul>
                        <p><strong>Note:</strong> Extraction time depends on the ISO size and your drive speed. The process will mount the ISO, copy all files, and then dismount automatically.</p>

                        <h3 style="margin-top: 1.5rem; font-size: 1.1rem; color: var(--accent-color);">1b. Convert Image Format (Optional)</h3>
                        <p>After extraction, an optional conversion card appears. Windows images come in two formats:</p>
                        <ul>
                            <li><strong>WIM (Windows Imaging Format):</strong> Larger file size, but faster installation speed.</li>
                            <li><strong>ESD (Electronic Software Download):</strong> Highly compressed, results in a smaller ISO file.</li>
                        </ul>
                        <p>WIMUtil automatically detects your current format and displays conversion options:</p>
                        <ul>
                            <li><strong>WIM → ESD:</strong> Compresses the image to reduce the final ISO size.</li>
                            <li><strong>ESD → WIM:</strong> Decompresses for faster installation performance.</li>
                        </ul>
                        <div class="callout callout-info">
                            <div class="callout-title">ℹ️ Conversion Note</div>
                            <p>Conversion can take 10-20 minutes depending on your hardware. Most users can skip this step entirely—it's primarily for advanced users who have specific size or speed requirements.</p>
                        </div>
                    </div>
                </div>

                <div class="step-card">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h2>Add an Autounattend XML (Recommended)</h2>
                        <p>This is the "brain" of your customized installer. The <code>autounattend.xml</code> file automates the Windows setup process and applies your settings during installation. Select <strong>one</strong> of the following options:</p>
                        <ul>
                            <li><strong>Generate Winhance XML:</strong> Creates an XML file based on your <em>current selections in Winhance</em>. Your checked Windows Apps will be uninstalled, and all Optimize/Customize settings will be applied at their current states. This is the recommended option for most users.</li>
                            <li><strong>Download UnattendedWinstall XML:</strong> Downloads the latest pre-configured XML from the <a href="https://github.com/memstechtips/UnattendedWinstall" target="_blank">UnattendedWinstall</a> project on GitHub. Requires internet connection.</li>
                            <li><strong>Select XML File:</strong> Choose an existing <code>autounattend.xml</code> file from your computer. Use this if you've created a custom XML using the <a href="https://schneegans.de/windows/unattend-generator/" target="_blank">Schneegans XML Generator</a> or have a saved XML from a previous session.</li>
                        </ul>
                        <div class="callout callout-warning">
                            <div class="callout-title">Before Generating</div>
                            <p>Before clicking Generate, make sure your Winhance settings are configured exactly how you want them. Check the Windows Apps you want removed, and toggle all Optimize and Customize settings to your desired states. You can only use <strong>one</strong> XML file—they cannot be combined.</p>
                        </div>
                        <p>For a detailed explanation of what the autounattend.xml does, see the <a href="autounattend.html">Autounattend Guide</a>.</p>
                    </div>
                </div>

                <div class="step-card">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h2>Inject Drivers (Recommended)</h2>
                        <p>Ensure your hardware works perfectly immediately after installation by including drivers in your custom ISO.</p>
                        <ul>
                            <li><strong>Extract & Add System Drivers:</strong> Winhance exports all third-party drivers (WiFi, GPU, Chipset, Audio, etc.) from your <em>currently running system</em> and injects them into the installer. <strong>Highly recommended</strong> if you are reinstalling Windows on the same machine—your hardware will be fully functional immediately after installation.</li>
                            <li><strong>Add Custom Drivers:</strong> Select a folder containing <code>.inf</code> driver files. These will be added alongside any system-extracted drivers (they don't override each other).</li>
                        </ul>
                        <p><strong>How drivers are organized:</strong></p>
                        <ul>
                            <li><strong>WinPE Drivers</strong> (<code>sources/$WinpeDriver$</code>): Storage/disk controller drivers needed during Windows Setup to detect your disks.</li>
                            <li><strong>Post-Install Drivers</strong> (<code>sources/$OEM$/$$</code>): All other drivers (WiFi, GPU, Audio, etc.), copied to <code>C:\Windows\Drivers</code> and installed via the official Windows <code>SetupComplete.cmd</code> mechanism.</li>
                        </ul>

                        <h3 style="margin-top: 1.5rem; font-size: 1.1rem;">How Post-Install Drivers Are Installed</h3>
                        <p>WIMUtil uses Microsoft's official <code>SetupComplete.cmd</code> script mechanism—a batch file that Windows Setup automatically executes after installation completes. This script runs <code>pnputil /add-driver</code> to install each driver from the <code>C:\Windows\Drivers</code> folder. This is the same method used by OEMs and enterprises.</p>

                        <div class="callout callout-warning">
                            <div class="callout-title">SetupComplete.cmd Limitations</div>
                            <p>On Windows 8 and later, <code>SetupComplete.cmd</code> is disabled when Windows detects an OEM product key (typically embedded in laptop UEFI firmware), except for Enterprise editions. This means:</p>
                            <ul>
                                <li><strong>Consumer editions (Home, Pro) with OEM keys:</strong> SetupComplete.cmd won't run, so drivers won't be installed automatically.</li>
                                <li><strong>Windows 10 IoT Enterprise LTSC:</strong> SetupComplete.cmd is blocked even though it's an Enterprise edition. Use the standard Windows 10 Enterprise LTSC ISO instead and activate with your IoT LTSC key after installation.</li>
                                <li><strong>Windows 11 IoT Enterprise LTSC:</strong> Works correctly by default.</li>
                            </ul>
                            <p>If your drivers weren't installed automatically, you can install them manually from Device Manager by browsing to <code>C:\Windows\Drivers</code>.</p>
                        </div>

                        <div class="callout callout-info">
                            <div class="callout-title">ℹ️ Driver Location After Install</div>
                            <p>After Windows is installed, you can find the extracted drivers at <code>C:\Windows\Drivers</code>. If any driver wasn't installed automatically, open Device Manager, right-click on the device with a missing driver, select "Update driver" → "Browse my computer for drivers" and point it to this folder.</p>
                        </div>
                    </div>
                </div>

                <div class="step-card">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h2>Create the Bootable ISO</h2>
                        <p>The final step combines everything into a single bootable ISO file.</p>
                        <ul>
                            <li><strong>Download oscdimg (if needed):</strong> Winhance uses <code>oscdimg.exe</code> from the official Windows ADK (Assessment and Deployment Kit) to create bootable ISOs. If it's not detected on your system, click the <strong>Download</strong> button. Winhance will automatically download and install only the required ADK Deployment Tools component. This is a one-time installation and requires internet access.</li>
                            <li>Once oscdimg is available, choose an <strong>Output Location</strong> for your new ISO file.</li>
                            <li>Click <strong>Create ISO</strong>.</li>
                        </ul>
                        <p><strong>What happens:</strong> Winhance uses <code>oscdimg.exe</code> to create a dual-boot ISO that works with both <strong>UEFI</strong> and <strong>Legacy BIOS</strong> systems. The resulting ISO is a fully bootable Windows installer containing your XML file, drivers, and any other customizations.</p>
                        <div class="callout callout-info">
                            <div class="callout-title">ℹ️ ISO Size</div>
                            <p>Your custom ISO will be larger than the original due to the added drivers and configurations. For example, a 7.5GB Windows 11 ISO might become 9-10GB with drivers included.</p>
                        </div>
                    </div>
                </div>

                <div class="callout callout-info">
                    <div class="callout-title">ℹ️ Post-Installation: Install Winhance Shortcut</div>
                    <p>When you install Windows using an ISO created with a Winhance-generated XML, a shortcut titled <strong>"Install Winhance"</strong> will be placed on your new desktop. Running this shortcut will automatically download and install the latest version of Winhance from GitHub, allowing you to:</p>
                    <ul>
                        <li>Install additional software from the External Software section (browsers, utilities, etc.)</li>
                        <li>Fine-tune any settings that weren't included in the XML</li>
                        <li>Manage Windows apps and features</li>
                    </ul>
                    <p><strong>Note:</strong> This shortcut requires an internet connection. If you removed Microsoft Edge during installation, you won't have a browser until you install one via Winhance or WinGet.</p>
                </div>

                <div class="callout callout-success">
                    <div class="callout-title">Creating Bootable USB Media</div>
                    <p>Once your custom ISO is created, use one of these tools to create a bootable USB drive:</p>
                    <ul>
                        <li><strong><a href="https://github.com/ventoy/Ventoy/releases" target="_blank">Ventoy</a></strong> (Recommended): Install Ventoy to a USB drive once, then simply copy ISO files to it. You can store multiple ISOs and choose which one to boot. No need to reformat for each new ISO. <a href="https://youtu.be/4AGZQJTyCOs" target="_blank">Watch the Ventoy tutorial</a></li>
                        <li><strong><a href="https://rufus.ie/" target="_blank">Rufus</a></strong>: Traditional tool that writes a single ISO to a USB drive. Simple and reliable, but requires reformatting for each new ISO.</li>
                    </ul>
                    <p>After creating your bootable USB, boot from it and follow the normal Windows installation process. Your autounattend.xml will automatically apply your customizations!</p>
                </div>

                <div class="page-nav">
                    <a href="configuration-files.html" class="page-nav-btn prev">&larr; Configuration Files</a>
                    <a href="autounattend.html" class="page-nav-btn next">Autounattend Guide &rarr;</a>
                </div>
            </section>
        </main>
    </div>

    <button class="sidebar-toggle">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
    </button>

    <script src="../js/docs-theme.js"></script>
    <script src="../js/docs-navigation.js"></script>
    <script src="../js/docs-search.js"></script>
    <script src="../js/docs-config.js"></script>

    <!-- Documentation Footer -->
    <footer class="docs-footer">
        <div class="docs-footer-container">
            <div class="docs-footer-info">
                &copy; 2026 Winhance. Released under the MIT License.
            </div>
            <div class="docs-footer-meta">
                <div class="docs-meta-item">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/></svg>
                    <span class="docs-version">Docs v1.0.0</span>
                </div>
                <div class="docs-meta-item">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
                    <span class="docs-last-updated">Last Updated: Jan 29, 2026</span>
                </div>
            </div>
        </div>
    </footer>

</body>

</html>